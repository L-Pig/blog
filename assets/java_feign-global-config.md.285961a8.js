import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.96fe74fa.js";const d=JSON.parse('{"title":"Feign 相关内容","description":"","frontmatter":{},"headers":[],"relativePath":"java/feign-global-config.md","filePath":"java/feign-global-config.md","lastUpdated":1694404151000}'),p={name:"java/feign-global-config.md"},e=l(`<h1 id="feign-相关内容" tabindex="-1">Feign 相关内容 <a class="header-anchor" href="#feign-相关内容" aria-label="Permalink to &quot;Feign 相关内容&quot;">​</a></h1><h2 id="为feign添加全局配置和接口调用失败的后处理" tabindex="-1">为Feign添加全局配置和接口调用失败的后处理 <a class="header-anchor" href="#为feign添加全局配置和接口调用失败的后处理" aria-label="Permalink to &quot;为Feign添加全局配置和接口调用失败的后处理&quot;">​</a></h2><h4 id="编写配置类" tabindex="-1">编写配置类 <a class="header-anchor" href="#编写配置类" aria-label="Permalink to &quot;编写配置类&quot;">​</a></h4><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@Configuration</span></span>
<span class="line"><span style="color:#E1E4E8;">public </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">GlobalFeignConfiguration</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> final String </span><span style="color:#FFAB70;">AUTHORIZATION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Authorization&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> fianl String </span><span style="color:#FFAB70;">TOKEN_PREFIX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Bearer &quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    @Bean</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> RequestInterceptor </span><span style="color:#B392F0;">headerInterceptor</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> template </span><span style="color:#F97583;">-&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span></span>
<span class="line"><span style="color:#E1E4E8;">            Map&lt;String, Collection&lt;String&gt;&gt; headers </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ImmutableMap.</span><span style="color:#B392F0;">of</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">AUTHORIZATION</span><span style="color:#E1E4E8;">, Lists.</span><span style="color:#B392F0;">newArrayList</span><span style="color:#E1E4E8;">(String.</span><span style="color:#B392F0;">valueOf</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">TOKEN_PREFIX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;123553453dasdad&quot;</span><span style="color:#E1E4E8;">)));</span></span>
<span class="line"><span style="color:#E1E4E8;">            template.headers(headers);</span></span>
<span class="line"><span style="color:#E1E4E8;">        };</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@Configuration</span></span>
<span class="line"><span style="color:#24292E;">public </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">GlobalFeignConfiguration</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> final String </span><span style="color:#E36209;">AUTHORIZATION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Authorization&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> fianl String </span><span style="color:#E36209;">TOKEN_PREFIX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Bearer &quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    @Bean</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> RequestInterceptor </span><span style="color:#6F42C1;">headerInterceptor</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> template </span><span style="color:#D73A49;">-&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span></span>
<span class="line"><span style="color:#24292E;">            Map&lt;String, Collection&lt;String&gt;&gt; headers </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ImmutableMap.</span><span style="color:#6F42C1;">of</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">AUTHORIZATION</span><span style="color:#24292E;">, Lists.</span><span style="color:#6F42C1;">newArrayList</span><span style="color:#24292E;">(String.</span><span style="color:#6F42C1;">valueOf</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">TOKEN_PREFIX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;123553453dasdad&quot;</span><span style="color:#24292E;">)));</span></span>
<span class="line"><span style="color:#24292E;">            template.headers(headers);</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="接口调用失败的后处理" tabindex="-1">接口调用失败的后处理 <a class="header-anchor" href="#接口调用失败的后处理" aria-label="Permalink to &quot;接口调用失败的后处理&quot;">​</a></h4><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 实现TestFeignFeign接口的方法并编写对应处理即可</span></span>
<span class="line"><span style="color:#E1E4E8;">@Slf4j</span></span>
<span class="line"><span style="color:#E1E4E8;">@Component</span></span>
<span class="line"><span style="color:#E1E4E8;">public </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestFeignFallBack</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestFeign</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 实现TestFeignFeign接口的方法并编写对应处理即可</span></span>
<span class="line"><span style="color:#24292E;">@Slf4j</span></span>
<span class="line"><span style="color:#24292E;">@Component</span></span>
<span class="line"><span style="color:#24292E;">public </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestFeignFallBack</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestFeign</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="为feign接口添加全局配置和失败后处理" tabindex="-1">为Feign接口添加全局配置和失败后处理 <a class="header-anchor" href="#为feign接口添加全局配置和失败后处理" aria-label="Permalink to &quot;为Feign接口添加全局配置和失败后处理&quot;">​</a></h4><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">@</span><span style="color:#B392F0;">FeignClient</span><span style="color:#E1E4E8;">(name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;test-demo&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        configuration </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> GlobalFeignConfiguration.class, fallback </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> TestFeign.class)</span></span>
<span class="line"><span style="color:#E1E4E8;">public </span><span style="color:#F97583;">interface</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">TestFeign</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@</span><span style="color:#6F42C1;">FeignClient</span><span style="color:#24292E;">(name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;test-demo&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        configuration </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> GlobalFeignConfiguration.class, fallback </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> TestFeign.class)</span></span>
<span class="line"><span style="color:#24292E;">public </span><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TestFeign</span><span style="color:#24292E;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>`,8),o=[e];function t(r,c,i,E,y,u){return n(),a("div",null,o)}const g=s(p,[["render",t]]);export{d as __pageData,g as default};
